---
title: "Exporation"
author: "Avery Chan"
date: "9/22/2021"
output:
  html_document:
    df_print: paged
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggprism)
theme_set(theme_bw())
```

This is a toy data set derived from the General Social Survey that I intend to use for several purposes. First, the battery of abortion items can serve as toy data to illustrate mixed effects modeling as equivalent to a one-parameter (Rasch) model. Second, I include some covariates to also do some basic regressions. I think abortion opinions are useful learning tools for statistical inference for college students. Third, there's a time-series component as well for understanding how abortion attitudes have changed over time.  

Data include all General Social Survey observations from 1972 to 2018 for these variables. Be mindful of missing data.

| Variable | Description |
|---|---|
| id | a unique respondent identifier |
| year | the survey year |
| age | the respondent's age in years |
| race | the respondent's race, as character variable |
| sex | the respondent's gender, as character variable |
| hispaniccat | the respondent's Hispanic ethnicity, as character variable |
| educ | how many years the respondent spent in school |
| partyid | the respondent's party identification, as character variable |
| relactiv | the self-reported religious activity of the respondent on a 1:11 scale |
| abany | a binary variable that equals 1 if the respondent thinks abortion should be legal for any reason. 0 indicates no support for abortion for any reason. |
| abdefect | a numeric vector that equals 1 if the respondent thinks abortion should be legal if there is a serious defect in the fetus. 0 indicates no support for abortion in this circumstance. |
| abnomore | a numeric vector that equals 1 if the respondent thinks abortion should be legal if a woman is pregnant but wants no more children. 0 indicates no support for abortion in this circumstance. |
| abhlth | a numeric vector that equals 1 if the respondent thinks abortion should be legal if a pregnant woman's health is in danger. 0 indicates no support for abortion in this circumstance. |
| abpoor | a numeric vector that equals 1 if the respondent thinks abortion should be legal if a pregnant woman is poor and cannot afford more children. 0 indicates no support for abortion in this circumstance. |
| abrape | a numeric vector that equals 1 if the respondent thinks abortion should be legal if the woman became pregnant because of a rape. 0 indicates no support for abortion in this circumstance. |
| absingle | a numeric vector that equals 1 if the respondent thinks abortion should be legal if a pregnant woman is single and does not want to marry the man who impregnated her. 0 indicates no support for abortion in this circumstance. |
| pid | `partyid` recoded so that 7 = NA |
| hispanic | a dummy variable that equals 1 if the respondent is any way Hispanic |

```{r}
# Data from http://svmiller.com/stevedata/reference/gss_abortion.html
# raw_abr <- read_csv("gss_abortion.csv", col_types = "???????????????????")
raw_abr <- read_csv("gss_abortion.csv", col_types= cols(
  row_num = col_integer(),
  id = col_integer(),
  year = col_integer(),
  age = col_integer(),
  race = col_character(),
  sex = col_character(),
  hispaniccat = col_character(),
  educ = col_integer(),
  partyid = col_character(),
  relactiv = col_integer(),
  abany = col_logical(),
  abdefect = col_logical(),
  abnomore = col_logical(),
  abhlth = col_logical(),
  abpoor = col_logical(),
  abrape = col_logical(),
  absingle = col_logical(),
  pid = col_integer(),
  hispanic = col_logical()
))
```

Getting parsing error for the `relactiv` column which is "the self-reported religious activity of the respondent on a 1:11 scale." It expects it to be binary but it is actually on a 1:11 scale.

```{r}
raw_abr %>% dim()
raw_abr %>% view()
raw_abr %>% summary()
raw_abr %>% str()
```


```{r}
n = raw_abr %>% nrow()
na_counts <- raw_abr %>% is.na() %>% colSums() %>% as_tibble(rownames = "rowname") %>% mutate(p = value / n)
na_counts %>% arrange(desc(p))
```


